#!/usr/bin/env python
import Requirements
import argparse
import pprint
import os.path

args_parser = argparse.ArgumentParser(description = "Manage requirements, generates documents.")
args_parser.add_argument('req_files', nargs="*", type=str, help="Test file")
args_parser.add_argument('-d', '--dependencies', action='store_const', const=True, default=False, help="Produce the dependency.dot graph file.")

args = args_parser.parse_args()

req_dir = {}
roots = []
for f in args.req_files:
    if os.path.isdir(f):
        Requirements.parse_directory(f, req_dir)
    else:
        roots.append(Requirements.parse_recursive(f, req_dir))

if args.dependencies:
    with open("deps.dot", 'w') as dep_file:
        outlines = Requirements.dotify(req_dir)
        dep_file.write("\n".join(outlines))
    pass
    
